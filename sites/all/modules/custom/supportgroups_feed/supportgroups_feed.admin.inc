<?php

/**
 * Menu callback: Admin settings form
 */
function supportgroups_feed_admin_form() {

  $form['supportgroups_support_someone_url'] = array(
    '#title' => 'Turn on Support Someone URL',
    '#description' => 'Check this box to use the feed generated by the supportgroups feed module for the
    /support-groups/support-someone page.  If turning this on ensure that the corresponding master view is disabled',
    '#type' => 'checkbox',
    '#default_value' => variable_get('supportgroups_support_someone_url', 0),
  );

  $form['supportgroups_all_support_groups_url'] = array(
    '#title' => 'Turn on All Support Groups URL',
    '#description' => 'Check this box to use the feed generated by the supportgroups feed module for the
    /support-groups/all-support-groups-posts page.  If turning this on ensure that the corresponding master view is
    disabled',
    '#type' => 'checkbox',
    '#default_value' => variable_get('supportgroups_all_support_groups_url', 0),
  );

  $form['supportgroups_feed_number_notifications'] = array(
    '#title' => 'Number of notifications',
    '#description' => 'The number of notifications to display when clicking on the icon',
    '#type' => 'textfield',
    '#default_value' => variable_get('supportgroups_feed_number_notifications', 8),
  );

  $form['supportgroups_feed_notifications_batch'] = array(
    '#title' => 'Number of notifications per batch',
    '#description' => 'Notifications feed items are displayed per thread, so that if a person is involved in one
    conversation, then only one notification appears for the entire thread.  In order to get enough items to get the
    required number of notifications, we have to obtain many more notification entries.  This value should be set
    higher than the number of notifications to a multiple of 2, 3 or more.',
    '#type' => 'textfield',
    '#default_value' => variable_get('supportgroups_feed_notifications_batch', 24),
  );

  $form['supportgroups_individual_notification_cache'] = array(
    '#title' => 'Turn on Inidividual notification cache',
    '#description' => 'When this is turned on, notifications are cached individually rather than in bulk.',
    '#type' => 'checkbox',
    '#default_value' => variable_get('supportgroups_individual_notification_cache', 0),
  );

  $form['supportgroups_individual_notification_cache_duration'] = array(
    '#title' => 'Duration of Inidividual notification cache',
    '#description' => 'The period of time to leave the individual notification cache available before deleting it,
    in days.',
    '#type' => 'textfield',
    '#default_value' => variable_get('supportgroups_individual_notification_cache_duration', 1),
  );

  $form['#submit'][] = 'supportgroups_feed_admin_submit';
  return system_settings_form($form);
}

function supportgroups_feed_admin_submit($form, $form_state) {
  cache_clear_all();
}